<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="The first thing we'll always want to do after launching gdb is to set a breakpoint on explode_bomb. A breakpoint stops the code from executing it is reached....">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.Cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/assets/css/main.min.css ">
    <link rel="canonical" href="/2019/12/13/binary-bomb-phase-1/">
    <link rel="alternate" type="application/rss+xml" title="Caminek" href="/feed.xml ">
    
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Binary Bomb: Phase 1 | Caminek</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Binary Bomb: Phase 1" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The first thing we’ll always want to do after launching gdb is to set a breakpoint on explode_bomb. A breakpoint stops the code from executing it is reached. If you make a mistake, this will prevent the bomb from exploding." />
<meta property="og:description" content="The first thing we’ll always want to do after launching gdb is to set a breakpoint on explode_bomb. A breakpoint stops the code from executing it is reached. If you make a mistake, this will prevent the bomb from exploding." />
<link rel="canonical" href="/2019/12/13/binary-bomb-phase-1/" />
<meta property="og:url" content="/2019/12/13/binary-bomb-phase-1/" />
<meta property="og:site_name" content="Caminek" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-13T09:33:28-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Binary Bomb: Phase 1" />
<script type="application/ld+json">
{"datePublished":"2019-12-13T09:33:28-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/12/13/binary-bomb-phase-1/"},"description":"The first thing we’ll always want to do after launching gdb is to set a breakpoint on explode_bomb. A breakpoint stops the code from executing it is reached. If you make a mistake, this will prevent the bomb from exploding.","dateModified":"2019-12-13T09:33:28-05:00","url":"/2019/12/13/binary-bomb-phase-1/","headline":"Binary Bomb: Phase 1","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->






</head>


  <body>

    <header id="top">
    <div class="wrapper">
        
            <img src="/assets/img/misc/avatar.png" alt="site.icon" width="32" height="32" style="vertical-align:middle"/>
        
        <a href="/" class="brand">Caminek</a>
        <small></small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/series/">
                        
                            <i class="fa fa-book"></i>Series
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <h1>Binary Bomb: Phase 1</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i> 2019-12-13
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#reverse-engineering" title="Category: reverse-engineering" rel="category">reverse-engineering</a>&nbsp;
    
        <a href="/category/#x86-64" title="Category: x86-64" rel="category">x86-64</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#reverse-engineering" title="Tag: reverse-engineering" rel="tag">reverse-engineering</a-->
        <a href="/tag/#reverse-engineering" title="Tag: reverse-engineering" rel="tag">reverse-engineering</a>&nbsp;
    
        <!--a href="/tag/#binary-bomb" title="Tag: binary-bomb" rel="tag">binary-bomb</a-->
        <a href="/tag/#binary-bomb" title="Tag: binary-bomb" rel="tag">binary-bomb</a>&nbsp;
    
        <!--a href="/tag/#gdb" title="Tag: gdb" rel="tag">gdb</a-->
        <a href="/tag/#gdb" title="Tag: gdb" rel="tag">gdb</a>&nbsp;
    
        <!--a href="/tag/#x86-64" title="Tag: x86-64" rel="tag">x86-64</a-->
        <a href="/tag/#x86-64" title="Tag: x86-64" rel="tag">x86-64</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
            <p>Navigate to the directory in which you extracted the bomb from and start a gdb debugging session by typing the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gdb bomb
</code></pre></div></div>

<p>The first thing we’ll always want to do after launching gdb is to set a breakpoint on explode_bomb. A breakpoint stops the code from executing it is reached. If you make a mistake, this will prevent the bomb from exploding.  We can simply restart our session or exit gdb.</p>

<p>Set the breakpoint by typing the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>b explode_bomb
</code></pre></div></div>
<p>The letter b is shorthand for breakpoint. With gdb, you only need to type enough of a command such that it is unique. You’re welcome to use the full word or more letters if you choose. You can also press TAB to autocomplete a word.</p>

<p>You should now see a message that says:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Breakpoint 1 at 0x40143a
</code></pre></div></div>

<p>Now that its safe to play with the bomb, let’s start by disassembling Phase 1. Start by typing:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>disas phase_1
</code></pre></div></div>

<p>The disas command is shorthand for disassemble. The phase_1 argument is the function we want to disasssemble. We know this exists from both the bomb.c file and from objdump.</p>

<p>Below is the output:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dump of assembler code for function phase_1:
   0x0000000000400ee0 &lt;+0&gt;: 	sub    rsp,0x8
   0x0000000000400ee4 &lt;+4&gt;: 	mov    esi,0x402400
   0x0000000000400ee9 &lt;+9&gt;: 	call   0x401338 &lt;strings_not_equal&gt;
   0x0000000000400eee &lt;+14&gt;:	test   eax,eax
   0x0000000000400ef0 &lt;+16&gt;:	je     0x400ef7 &lt;phase_1+23&gt;
   0x0000000000400ef2 &lt;+18&gt;:	call   0x40143a &lt;explode_bomb&gt;
   0x0000000000400ef7 &lt;+23&gt;:	add    rsp,0x8
   0x0000000000400efb &lt;+27&gt;:	ret    
End of assembler dump.
</code></pre></div></div>

<p>By its name, the function would appear to compare two strings and set a value into the EAX register based on whether that were equal or not.</p>

<blockquote>
  <p>Normally, we’d want to check to make sure the strings_not_equal function worked as we’ve assumed, or for that matter that explode_bomb does what it says. Given the nature of the assignment, I had opted to trust the named functions worked as expected. If I hadn’t trusted them, I would have set a breakpoint for phase_1 and executed the instructions one-by-one, or at least disassembled the functions and reviewed them.</p>
</blockquote>

<p>Right before the call to the strings_not_equal function, we see a mov instruction. Something is being moved into the ESI register. This is done to provide the function that is being called with the arguments it will need. Let’s look to see what’s at location 0x402400:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>x/s 0x402400
0x402400:	"Border relations with Canada have never been better."
</code></pre></div></div>

<p>Here the ‘x’ stands for examine, and the ‘s’ for string. We’re telling gdb to examine 
0x402400 as a string. The output appears quite promising! Let’s try submitting this string to the bomb and see what happens. Remember, if we accidentally enter the wrong information, we’ll be protected by the breakpoint set for explode_bomb.</p>

<p>To start the bomb type run or simply the letter ‘r’ to run the bomb from within gdb. Do not run the bomb outside of gdb until all phases are solved!</p>

<p>Paste in the string from above, without the quotes and you should see:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Welcome to my fiendish little bomb. You have 6 phases with
which to blow yourself up. Have a nice day!
Border relations with Canada have never been better.
Phase 1 defused. How about the next one?
</code></pre></div></div>

<p>To exit the running bomb session you can either press Ctrl-C and then type quit, or you can exit the terminal.</p>

<h1 id="answer-file">Answer file</h1>

<p>This part is optional but highly recommended. This phase was the easiest of them all. The subsequent phases won’t give up their secrets so easily. We’ll need to enter random input just to see how the bomb processes it. From this, we’ll attempt to work out what the correct response to the phase. This means we’ll have to restart the bomb multiple times and enter the responses for the previous phases in the process. To make this easier, we can create a file with all of our correct answers for each phase and feed that into the bomb. This will save a lot of time and copy/pasting.</p>

<p>Create a text file and enter the string we just used to solve Phase 1. Make sure you press enter afterward or the bomb will detonate after reading the file. Save the file in the same directory as the bomb. I will refer to this file as answers.txt, though you’re welcome to name the file whatever you want.</p>

        </article>
        <hr>
        

        <div class="post-recent">
    <div class="pre" style="display:inline-block; margin-top: 20px;">
        
        <p><i class="fa fa-arrow-left"></i> <a href="/2019/12/12/binary-bomb-phase-0/">Binary Bomb: Phase 0</a></p>
        
    </div>
    <div class="nex" style="display:inline-block; margin-top: 20px; float:right;">
        
        <p><a href="/2019/12/16/binary-bomb-phase-2/">Binary Bomb: Phase 2</a> <i class="fa fa-arrow-right"></i></p>
        
    </div>
</div>

        
        
        

    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <!-- <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div> -->

            <!-- Series -->
            
            <div class="side">
                <div>
                    <i class="fa fa-book" aria-hidden="true"></i>
                    Series
                </div>
 
                <ul class="content-ul" recent>
                     <!--for loop is 0 based. this prevents off-by-one errors -->
                    

                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                            

                            <!-- prevent Series from showing < 5 entries when near the end of series -->
                            
                        
                    
                        

                        
                    
                    

                    <!-- prevent Series from showing < 5 entries when near the start of series -->
                    

                    


                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                </ul>
            </div>
            

            
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    Recent Posts
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2021/05/23/bandit33-34/">Bandit Level 33 → Level 34</a></li>
                    
                        <li><a href="/2021/05/23/bandit32-33/">Bandit Level 32 → Level 33</a></li>
                    
                        <li><a href="/2021/05/23/bandit31-32/">Bandit Level 31 → Level 32</a></li>
                    
                        <li><a href="/2021/05/23/bandit30-31/">Bandit Level 30 → Level 31</a></li>
                    
                        <li><a href="/2021/05/23/bandit29-30/">Bandit Level 29 → Level 30</a></li>
                    
                </ul>
            </div>

            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    Categories
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#reverse-engineering" class="categories-list-item" cate="reverse-engineering">
                            <span class="name">
                                reverse-engineering
                            </span>
                            <span class="badge">13</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#x86-64" class="categories-list-item" cate="x86-64">
                            <span class="name">
                                x86-64
                            </span>
                            <span class="badge">8</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#ctf" class="categories-list-item" cate="ctf">
                            <span class="name">
                                ctf
                            </span>
                            <span class="badge">40</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#wargames" class="categories-list-item" cate="wargames">
                            <span class="name">
                                wargames
                            </span>
                            <span class="badge">35</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#linux" class="categories-list-item" cate="linux">
                            <span class="name">
                                linux
                            </span>
                            <span class="badge">35</span>
                        </a>
                    </li>
                    
                </ul>
            </div>

            <!-- Tag Cloud -->
            
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<!-- <script src="/assets/js/pageContent.js " charset="utf-8"></script> -->


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
            
        </p>
        <p class="contact">
            Find me on: 
            <a href="https://github.com/caminek" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> 
             
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>, and modified by <a href="https://github.com/caminek">caminek</a>.
            </span>
        </p>
    </div>
</footer>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <!-- <script src=" /assets/js/main.js " charset="utf-8"></script>
    <script src=" /assets/js/smooth-scroll.min.js " charset="utf-8"></script> -->
    <script src=" /assets/js/all.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /assets/js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
