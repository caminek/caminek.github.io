<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="This isn't an official phase of the binary bomb lab. This is meant to document what we need to do before launching the bomb for the first time.">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.Cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/assets/css/main.min.css ">
    <link rel="canonical" href="https://caminek.rocks/2019/12/12/binary-bomb-phase-0/">
    <link rel="alternate" type="application/rss+xml" title="Caminek" href="https://caminek.rocks/feed.xml ">
    
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Binary Bomb: Phase 0 | Caminek</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Binary Bomb: Phase 0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This isn’t an official phase of the binary bomb lab. This is meant to document what we need to do before launching the bomb for the first time." />
<meta property="og:description" content="This isn’t an official phase of the binary bomb lab. This is meant to document what we need to do before launching the bomb for the first time." />
<link rel="canonical" href="https://caminek.rocks/2019/12/12/binary-bomb-phase-0/" />
<meta property="og:url" content="https://caminek.rocks/2019/12/12/binary-bomb-phase-0/" />
<meta property="og:site_name" content="Caminek" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-12T16:14:54-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Binary Bomb: Phase 0" />
<script type="application/ld+json">
{"@type":"BlogPosting","description":"This isn’t an official phase of the binary bomb lab. This is meant to document what we need to do before launching the bomb for the first time.","headline":"Binary Bomb: Phase 0","dateModified":"2019-12-12T16:14:54-05:00","datePublished":"2019-12-12T16:14:54-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://caminek.rocks/2019/12/12/binary-bomb-phase-0/"},"url":"https://caminek.rocks/2019/12/12/binary-bomb-phase-0/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->






</head>


  <body>

    <header id="top">
    <div class="wrapper">
        
            <img src="/assets/img/misc/avatar.png" alt="site.icon" width="32" height="32" style="vertical-align:middle"/>
        
        <a href="/" class="brand">Caminek</a>
        <small></small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/series/">
                        
                            <i class="fa fa-book"></i>Series
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <h1>Binary Bomb: Phase 0</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i> 2019-12-12
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#reverse-engineering" title="Category: reverse-engineering" rel="category">reverse-engineering</a>&nbsp;
    
        <a href="/category/#x86-64" title="Category: x86-64" rel="category">x86-64</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#reverse-engineering" title="Tag: reverse-engineering" rel="tag">reverse-engineering</a-->
        <a href="/tag/#reverse-engineering" title="Tag: reverse-engineering" rel="tag">reverse-engineering</a>&nbsp;
    
        <!--a href="/tag/#binary-bomb" title="Tag: binary-bomb" rel="tag">binary-bomb</a-->
        <a href="/tag/#binary-bomb" title="Tag: binary-bomb" rel="tag">binary-bomb</a>&nbsp;
    
        <!--a href="/tag/#objdump" title="Tag: objdump" rel="tag">objdump</a-->
        <a href="/tag/#objdump" title="Tag: objdump" rel="tag">objdump</a>&nbsp;
    
        <!--a href="/tag/#x86-64" title="Tag: x86-64" rel="tag">x86-64</a-->
        <a href="/tag/#x86-64" title="Tag: x86-64" rel="tag">x86-64</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
            <h1 id="about">About</h1>

<p>These writeups document the steps needed to defuse the self-study version of the <a href="https://csapp.cs.cmu.edu/3e/labs.html">CMU Bomb Lab</a>. The installation and configuration of the tools and environments are left for the reader.</p>

<p>The phases are initially verbose in their explanation of tools and certain assembly instructions. As we move through the phases, they will become less so. This is due to the increasing complexity of the phases and the expectation that the reader now understands these concepts.</p>

<h1 id="phase-0">Phase 0</h1>

<p>This isn’t an official phase of the binary bomb lab.  This is meant to document what we need to do before launching the bomb for the first time.  Mainly, we need to gather a little information about the bomb and make sure our tools are in place.</p>

<h2 id="tools">Tools</h2>

<p>The only tools we’ll need are gdb and objdump. While strings can be used, I found that it tends to lead people into guessing.  There’s plenty of false flags to frustrate you. There’s some valuable information to be gained, but nothing we won’t find in gdb. I won’t be using strings in this writeup, but you’re welcome to try it if you’d like.</p>

<p>You might also be interested in gdb enhancements, such as <a href="https://gef.readthedocs.io/en/master/">gef</a>. While helpful, they’re not required for this lab.</p>

<h2 id="configure-gdb">Configure gdb</h2>

<p>One configuration you’ll need to make to work with these writeups is to use Intel notation instead of the default AT&amp;T notation.  You could type the following after starting every gdb session:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set disassembly-flavor intel
</code></pre></div></div>

<p>The other option is to include this line in .gdbinit:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"set disassembly-flavor intel"</span> <span class="o">&gt;&gt;</span> ~/.gdbinit
</code></pre></div></div>

<p>If you opt to use gef, you won’t need to add this line. It’s part of the default configuration.</p>

<h1 id="gathering-information">Gathering Information</h1>

<p>Download the bomb from the CMU Bomb Lab, and extract it. You’ll see two files of interest, <strong>bomb.c</strong>, and <strong>bomb</strong>.</p>

<h2 id="bombc">bomb.c</h2>

<p>In bomb.c, we see some valuable information:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">printf</span><span class="p">(</span><span class="s">"Welcome to my fiendish little bomb. You have 6 phases with</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"which to blow yourself up. Have a nice day!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    
    <span class="n">input</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">();</span>
    <span class="n">phase_1</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
    
    <span class="cm">/* Wow, they got it!  But isn't something... missing?  Perhaps
     * something they overlooked?  Mua ha ha ha ha! */</span>
</code></pre></div></div>

<p>Here we can see that the bomb has 6 phases, each phase has a function named after it, and we’re likely going to miss something.</p>

<h2 id="bomb">bomb</h2>

<h3 id="objdump--t">objdump -t</h3>

<p>Since the bomb contains debugging info, we’ll be able to recover the name of the functions in the program. As we saw in bomb.c, the author used descriptive function names. Let’s see what other functions might be included. Open a terminal and navigate to the directory that contains the bomb file.</p>

<p>Enter the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>objdump <span class="nt">-t</span> bomb | <span class="nb">grep </span>text | <span class="nb">awk</span> <span class="s1">'{print $NF}'</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"^_"</span> | <span class="nb">sort</span>
</code></pre></div></div>

<p>The -t flag tells objdump that we’re only interested in the symbol table. We pipe the results into grep to give us only the .text section since that contains a list of the entry points (functions, variables, etc…) within the program.</p>

<p>Since we’re only interested in the function names, and not their entry points, we use awk to clean up the output. Using $NF will get us the last field in every line which happens to be the names.</p>

<p>Next, we send the output to grep to match any name that does not start with an underscore. While this isn’t strictly necessary given that there are only 4 matches, it does make the output cleaner.</p>

<p>Lastly, we sort the output alphabetically.</p>

<p>Here’s what you should see:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>blank_line
call_gmon_start
deregister_tm_clones
driver_post
explode_bomb
frame_dummy
fun7
func4
init_driver
initialize_bomb
initialize_bomb_solve
init_timeout
invalid_phase
main
phase_1
phase_2
phase_3
phase_4
phase_5
phase_6
phase_defused
read_line
read_six_numbers
register_tm_clones
rio_readlineb
secret_phase
sigalrm_handler
sig_handler
skip
string_length
strings_not_equal
submitr
.text
</code></pre></div></div>

<p>Reading through the list, we see a couple of interesting names: <strong>explode_bomb</strong> and <strong>secret_phase</strong>.</p>

<p>The explode_bomb function is what is called when we enter bad input.  Knowing its name, we can watch for this function to be called and stop the program from executing it. TThis will save us from detonating the bomb if we supply the wrong information.</p>

<p>The secret_phase function would appear to be the thing we were likely going to miss. Now that we know its there, we can search for it.</p>

<h3 id="optional-objdump--d">Optional: objdump -d</h3>

<p>You can use objdump to disassemble the bomb for further analysis. While I won’t be using this, I’ve included it for the sake of completeness. I’ll use gdb for disassembly and including that within the individual phase writeups.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>objdump <span class="nt">-M</span> intel <span class="nt">-d</span> bomb <span class="o">&gt;</span> bomb-objdump.txt
</code></pre></div></div>

<p>By default, objdump will disassemble into AT&amp;T syntax. While it looks similar, it reads differently than the Intel syntax. We’ll use the -M option to convert the output.</p>

<p>By using the -d option you can exclude non-executable sections of the bomb. If you’d prefer, use -D and everything will be included in the output.</p>

<h1 id="what-we-know-so-far">What we know so far</h1>

<ul>
  <li>We have six functions named the six phases of the bomb.</li>
  <li>There’s a secret phase</li>
  <li>The phase_defused function plays some role in accessing the secret phase</li>
  <li>There’s a function named explode_bomb that we watch for to prevent the bomb from exploding</li>
</ul>

<p>With this, we’re ready to start phase 1!</p>

        </article>
        <hr>
        

        <div class="post-recent">
    <div class="pre" style="display:inline-block; margin-top: 20px;">
        
    </div>
    <div class="nex" style="display:inline-block; margin-top: 20px; float:right;">
        
        <p><a href="/2019/12/13/binary-bomb-phase-1/">Binary Bomb: Phase 1</a> <i class="fa fa-arrow-right"></i></p>
        
    </div>
</div>

        
        
        

    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <!-- <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div> -->

            <!-- Series -->
            
            <div class="side">
                <div>
                    <i class="fa fa-book" aria-hidden="true"></i>
                    Series
                </div>
 
                <ul class="content-ul" recent>
                     <!--for loop is 0 based. this prevents off-by-one errors -->
                    

                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                    
                        

                        
                            

                            <!-- prevent Series from showing < 5 entries when near the end of series -->
                            
                        
                    
                    

                    <!-- prevent Series from showing < 5 entries when near the start of series -->
                    

                    


                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                </ul>
            </div>
            

            
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    Recent Posts
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2021/05/30/natas24-25/">Natas Level 24 → Level 25</a></li>
                    
                        <li><a href="/2021/05/30/natas23-24/">Natas Level 23 → Level 24</a></li>
                    
                        <li><a href="/2021/05/30/natas22-23/">Natas Level 22 → Level 23</a></li>
                    
                        <li><a href="/2021/05/30/natas21-22/">Natas Level 21 → Level 22</a></li>
                    
                        <li><a href="/2021/05/30/natas20-21/">Natas Level 20 → Level 21</a></li>
                    
                </ul>
            </div>

            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    Categories
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#reverse-engineering" class="categories-list-item" cate="reverse-engineering">
                            <span class="name">
                                reverse-engineering
                            </span>
                            <span class="badge">13</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#x86-64" class="categories-list-item" cate="x86-64">
                            <span class="name">
                                x86-64
                            </span>
                            <span class="badge">8</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#ctf" class="categories-list-item" cate="ctf">
                            <span class="name">
                                ctf
                            </span>
                            <span class="badge">66</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#wargames" class="categories-list-item" cate="wargames">
                            <span class="name">
                                wargames
                            </span>
                            <span class="badge">61</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#linux" class="categories-list-item" cate="linux">
                            <span class="name">
                                linux
                            </span>
                            <span class="badge">35</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#web-security" class="categories-list-item" cate="web-security">
                            <span class="name">
                                web-security
                            </span>
                            <span class="badge">26</span>
                        </a>
                    </li>
                    
                </ul>
            </div>

            <!-- Tag Cloud -->
            
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<!-- <script src="/assets/js/pageContent.js " charset="utf-8"></script> -->


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
            
        </p>
        <p class="contact">
            Find me on: 
            <a href="https://github.com/caminek" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> 
             
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>, and modified by <a href="https://github.com/caminek">caminek</a>.
            </span>
        </p>
    </div>
</footer>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <!-- <script src=" /assets/js/main.js " charset="utf-8"></script>
    <script src=" /assets/js/smooth-scroll.min.js " charset="utf-8"></script> -->
    <script src=" /assets/js/all.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /assets/js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
